{"version":3,"sources":["y-axis.js"],"names":["YAxis","height","width","event","nativeEvent","layout","setState","domain","props","scale","spacingInner","spacingOuter","contentInset","top","bottom","state","y","range","d3Scale","scaleBand","paddingInner","paddingOuter","value","bandwidth","style","data","yAccessor","numberOfTicks","formatLabel","svg","children","length","values","map","item","index","extent","array","min","max","getY","ticks","longestValue","reduce","prev","curr","toString","console","log","extraProps","flexGrow","_onLayout","opacity","fontSize","position","left","React","Children","child","cloneElement","PureComponent","propTypes","PropTypes","oneOfType","arrayOf","object","number","isRequired","any","func","shape","defaultProps","scaleLinear"],"mappings":"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","sourcesContent":["import React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {Text, View} from 'react-native';\nimport {Svg, G, Text as SVGText} from 'react-native-svg';\nimport * as d3Scale from 'd3-scale';\nimport * as array from 'd3-array';\n\nclass YAxis extends PureComponent {\n  state = {\n    height: 0,\n    width: 0,\n  };\n\n  _onLayout(event) {\n    const {\n      nativeEvent: {\n        layout: {height, width},\n      },\n    } = event;\n    this.setState({height, width});\n  }\n\n  getY(domain) {\n    const {\n      scale,\n      spacingInner,\n      spacingOuter,\n      contentInset: {top = 0, bottom = 0},\n    } = this.props;\n\n    const {height} = this.state;\n\n    const y = scale()\n      .domain(domain)\n      .range([height - bottom, top]);\n\n    if (scale === d3Scale.scaleBand) {\n      // use index as domain identifier instead of value since\n      // same value can occur at several places in dataPoints\n      y\n        // set range top to bottom - we are not sorting on values in scaleBand\n        .range([top, height - bottom])\n        .paddingInner([spacingInner])\n        .paddingOuter([spacingOuter]);\n\n      //add half a bar to center label\n      return (value) => y(value) + y.bandwidth() / 2;\n    }\n\n    return y;\n  }\n\n  render() {\n    const {\n      style,\n      data,\n      scale,\n      yAccessor,\n      numberOfTicks,\n      formatLabel,\n      svg,\n      children,\n    } = this.props;\n\n    const {height, width} = this.state;\n\n    if (data.length === 0) {\n      return <View style={style} />;\n    }\n\n    const values = data.map((item, index) => yAccessor({item, index}));\n\n    const extent = array.extent([...values, min, max]);\n\n    const {min = extent[0], max = extent[1]} = this.props;\n\n    const domain = scale === d3Scale.scaleBand ? values : [min, max];\n\n    //invert range to support svg coordinate system\n    const y = this.getY(domain);\n\n    const ticks = scale === d3Scale.scaleBand ? values : y.ticks(numberOfTicks);\n\n    const longestValue = ticks\n      .map((value, index) => formatLabel(value, index))\n      .reduce(\n        (prev, curr) =>\n          prev.toString().length > curr.toString().length ? prev : curr,\n        0,\n      );\n\n    console.log('longestValue :', longestValue);\n\n    const extraProps = {\n      y,\n      ticks,\n      width,\n      formatLabel,\n    };\n\n    return (\n      <View style={[style]}>\n        <View style={{flexGrow: 1}} onLayout={(event) => this._onLayout(event)}>\n          {/*invisible text to allow for parent resizing*/}\n          <Text style={{opacity: 0, fontSize: svg.fontSize}}>\n            {longestValue}\n          </Text>\n          {height > 0 && width > 0 && (\n            <Svg\n              style={{\n                position: 'absolute',\n                top: 0,\n                left: 0,\n                height,\n                width,\n              }}>\n              <G>\n                {React.Children.map(children, (child) => {\n                  return React.cloneElement(child, extraProps);\n                })}\n                {// don't render labels if width isn't measured yet,\n                // causes rendering issues\n                height > 0 &&\n                  ticks.map((value, index) => {\n                    return (\n                      <SVGText\n                        originY={y(value)}\n                        textAnchor={'middle'}\n                        x={'50%'}\n                        alignmentBaseline={'middle'}\n                        {...svg}\n                        key={index}\n                        y={y(value)}>\n                        {formatLabel(value, index)}\n                      </SVGText>\n                    );\n                  })}\n              </G>\n            </Svg>\n          )}\n        </View>\n      </View>\n    );\n  }\n}\n\nYAxis.propTypes = {\n  data: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.object),\n    PropTypes.arrayOf(PropTypes.number),\n  ]).isRequired,\n  svg: PropTypes.object,\n  style: PropTypes.any,\n  numberOfTicks: PropTypes.number,\n  formatLabel: PropTypes.func,\n  contentInset: PropTypes.shape({\n    top: PropTypes.number,\n    bottom: PropTypes.number,\n  }),\n  min: PropTypes.number,\n  max: PropTypes.number,\n  yAccessor: PropTypes.func,\n  scale: PropTypes.func,\n  spacingInner: PropTypes.number,\n  spacingOuter: PropTypes.number,\n};\n\nYAxis.defaultProps = {\n  numberOfTicks: 10,\n  spacingInner: 0.05,\n  spacingOuter: 0.05,\n  contentInset: {},\n  svg: {},\n  scale: d3Scale.scaleLinear,\n  formatLabel: (value) => value && value.toString(),\n  yAccessor: ({item}) => item,\n};\n\nexport default YAxis;\n"]}