{"version":3,"sources":["pie-chart.js"],"names":["React","PureComponent","View","Platform","PropTypes","shape","Svg","G","Path","PieChart","height","width","_onLayout","event","nativeEvent","layout","setState","_calculateRadius","arg","max","defaultVal","split","render","data","dataPoints","innerRadius","outerRadius","labelRadius","padAngle","animate","animationDuration","style","sort","valueAccessor","children","startAngle","endAngle","props","state","length","maxRadius","Math","min","map","obj","item","console","error","_outerRadius","_innerRadius","_labelRadius","warn","arcs","arc","Object","entries","forEach","key","value","labelArcs","index","pieSlices","pie","d","slices","slice","pieCentroid","centroid","labelCentroid","extraProps","flex","OS","Children","child","belowChart","cloneElement","onPress","svg","propTypes","arrayOf","object","any","isRequired","number","oneOfType","string","bool","func","defaultProps","PI","a","b"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react'\nimport { View, Platform } from 'react-native'\nimport PropTypes from 'prop-types'\nimport * as shape from 'd3-shape'\nimport Svg, { G, Path } from 'react-native-svg'\n\nclass PieChart extends PureComponent {\n    state = {\n        height: 0,\n        width: 0,\n    }\n\n    _onLayout(event) {\n        const {\n            nativeEvent: {\n                layout: { height, width },\n            },\n        } = event\n\n        this.setState({ height, width })\n    }\n\n    _calculateRadius(arg, max, defaultVal) {\n        if (typeof arg === 'string') {\n            return (arg.split('%')[0] / 100) * max\n        } else if (arg) {\n            return arg\n        } else {\n            return defaultVal\n        }\n    }\n\n    render() {\n        const {\n            data,\n            dataPoints,\n            innerRadius,\n            outerRadius,\n            labelRadius,\n            padAngle,\n            animate,\n            animationDuration,\n            style,\n            sort,\n            valueAccessor,\n            children,\n            startAngle,\n            endAngle,\n        } = this.props\n\n        const { height, width } = this.state\n\n        if (!data && dataPoints) {\n            throw `\"dataPoints\" have been renamed to \"data\" to better reflect the fact that it's an array of objects`\n        }\n\n        if (data.length === 0) {\n            return <View style={style} />\n        }\n\n        const maxRadius = Math.min(width, height) / 2\n\n        if (Math.min(...data.map((obj) => valueAccessor({ item: obj }))) < 0) {\n            console.error(\"don't pass negative numbers to pie-chart, it makes no sense!\")\n        }\n\n        const _outerRadius = this._calculateRadius(outerRadius, maxRadius, maxRadius)\n        const _innerRadius = this._calculateRadius(innerRadius, maxRadius, 0)\n        const _labelRadius = this._calculateRadius(labelRadius, maxRadius, _outerRadius)\n\n        if (outerRadius > 0 && _innerRadius >= outerRadius) {\n            console.warn('innerRadius is equal to or greater than outerRadius')\n        }\n\n        const arcs = data.map((item) => {\n            const arc = shape\n                .arc()\n                .outerRadius(_outerRadius)\n                .innerRadius(_innerRadius)\n                .padAngle(padAngle) // Angle between sections\n\n            item.arc &&\n                Object.entries(item.arc).forEach(([key, value]) => {\n                    if (typeof arc[key] === 'function') {\n                        if (typeof value === 'string') {\n                            arc[key]((value.split('%')[0] / 100) * _outerRadius)\n                        } else {\n                            arc[key](value)\n                        }\n                    }\n                })\n\n            return arc\n        })\n\n        const labelArcs = data.map((item, index) => {\n            if (labelRadius) {\n                return shape\n                    .arc()\n                    .outerRadius(_labelRadius)\n                    .innerRadius(_labelRadius)\n                    .padAngle(padAngle)\n            }\n            return arcs[index]\n        })\n\n        const pieSlices = shape\n            .pie()\n            .value((d) => valueAccessor({ item: d }))\n            .sort(sort)\n            .startAngle(startAngle)\n            .endAngle(endAngle)(data)\n\n        const slices = pieSlices.map((slice, index) => ({\n            ...slice,\n            pieCentroid: arcs[index].centroid(slice),\n            labelCentroid: labelArcs[index].centroid(slice),\n        }))\n\n        const extraProps = {\n            width,\n            height,\n            data,\n            slices,\n        }\n\n        return (\n            <View pointerEvents={'box-none'} style={style}>\n                <View pointerEvents={'box-none'} style={{ flex: 1 }} onLayout={(event) => this._onLayout(event)}>\n                    {height > 0 && width > 0 && (\n                        <Svg pointerEvents={Platform.OS === 'android' && 'box-none'} style={{ height, width }}>\n                            {/* center the progress circle*/}\n                            <G x={width / 2} y={height / 2}>\n                                {React.Children.map(children, (child) => {\n                                    if (child && child.props.belowChart) {\n                                        return React.cloneElement(child, extraProps)\n                                    }\n                                    return null\n                                })}\n                                {pieSlices.map((slice, index) => {\n                                    const { key, onPress, svg } = data[index]\n                                    return (\n                                        <Path\n                                            key={key}\n                                            onPress={onPress}\n                                            {...svg}\n                                            d={arcs[index](slice)}\n                                            animate={animate}\n                                            animationDuration={animationDuration}\n                                        />\n                                    )\n                                })}\n                                {React.Children.map(children, (child) => {\n                                    if (child && !child.props.belowChart) {\n                                        return React.cloneElement(child, extraProps)\n                                    }\n                                    return null\n                                })}\n                            </G>\n                        </Svg>\n                    )}\n                </View>\n            </View>\n        )\n    }\n}\n\nPieChart.propTypes = {\n    data: PropTypes.arrayOf(\n        PropTypes.shape({\n            svg: PropTypes.object,\n            key: PropTypes.any.isRequired,\n            value: PropTypes.number,\n            arc: PropTypes.object,\n        })\n    ).isRequired,\n    innerRadius: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    outerRadius: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    labelRadius: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    padAngle: PropTypes.number,\n    animate: PropTypes.bool,\n    animationDuration: PropTypes.number,\n    style: PropTypes.any,\n    sort: PropTypes.func,\n    valueAccessor: PropTypes.func,\n}\n\nPieChart.defaultProps = {\n    width: 100,\n    height: 100,\n    padAngle: 0.05,\n    startAngle: 0,\n    endAngle: Math.PI * 2,\n    valueAccessor: ({ item }) => item.value,\n    innerRadius: '50%',\n    sort: (a, b) => b.value - a.value,\n}\n\nexport default PieChart\n"]}