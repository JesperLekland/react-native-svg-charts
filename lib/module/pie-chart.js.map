{"version":3,"sources":["pie-chart.js"],"names":["PieChart","height","width","event","nativeEvent","layout","setState","arg","max","defaultVal","split","props","data","dataPoints","innerRadius","outerRadius","labelRadius","padAngle","animate","animationDuration","style","sort","valueAccessor","children","startAngle","endAngle","state","length","maxRadius","Math","min","map","obj","item","console","error","_outerRadius","_calculateRadius","_innerRadius","_labelRadius","warn","arcs","arc","shape","Object","entries","forEach","key","value","labelArcs","index","pieSlices","pie","d","slices","slice","pieCentroid","centroid","labelCentroid","extraProps","flex","_onLayout","React","Children","child","belowChart","cloneElement","onPress","svg","PureComponent","propTypes","PropTypes","arrayOf","object","any","isRequired","number","oneOfType","string","bool","func","defaultProps","PI","a","b"],"mappings":"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","sourcesContent":["import React, {PureComponent} from 'react';\nimport {View} from 'react-native';\nimport PropTypes from 'prop-types';\nimport * as shape from 'd3-shape';\nimport Svg, {G, Path} from 'react-native-svg';\n\nclass PieChart extends PureComponent {\n  state = {\n    height: 0,\n    width: 0,\n  };\n\n  _onLayout(event) {\n    const {\n      nativeEvent: {\n        layout: {height, width},\n      },\n    } = event;\n\n    this.setState({height, width});\n  }\n\n  _calculateRadius(arg, max, defaultVal) {\n    if (typeof arg === 'string') {\n      return (arg.split('%')[0] / 100) * max;\n    } else if (arg) {\n      return arg;\n    } else {\n      return defaultVal;\n    }\n  }\n\n  render() {\n    const {\n      data,\n      dataPoints,\n      innerRadius,\n      outerRadius,\n      labelRadius,\n      padAngle,\n      animate,\n      animationDuration,\n      style,\n      sort,\n      valueAccessor,\n      children,\n      startAngle,\n      endAngle,\n    } = this.props;\n\n    const {height, width} = this.state;\n\n    if (!data && dataPoints) {\n      throw '\"dataPoints\" have been renamed to \"data\" to better reflect the fact that it\\'s an array of objects';\n    }\n\n    if (data.length === 0) {\n      return <View style={style} />;\n    }\n\n    const maxRadius = Math.min(width, height) / 2;\n\n    if (Math.min(...data.map((obj) => valueAccessor({item: obj}))) < 0) {\n      console.error(\n        \"don't pass negative numbers to pie-chart, it makes no sense!\",\n      );\n    }\n\n    const _outerRadius = this._calculateRadius(\n      outerRadius,\n      maxRadius,\n      maxRadius,\n    );\n    const _innerRadius = this._calculateRadius(innerRadius, maxRadius, 0);\n    const _labelRadius = this._calculateRadius(\n      labelRadius,\n      maxRadius,\n      _outerRadius,\n    );\n\n    if (outerRadius > 0 && _innerRadius >= outerRadius) {\n      console.warn('innerRadius is equal to or greater than outerRadius');\n    }\n\n    const arcs = data.map((item) => {\n      const arc = shape\n        .arc()\n        .outerRadius(_outerRadius)\n        .innerRadius(_innerRadius)\n        .padAngle(padAngle); // Angle between sections\n\n      item.arc &&\n        Object.entries(item.arc).forEach(([key, value]) => {\n          if (typeof arc[key] === 'function') {\n            if (typeof value === 'string') {\n              arc[key]((value.split('%')[0] / 100) * _outerRadius);\n            } else {\n              arc[key](value);\n            }\n          }\n        });\n\n      return arc;\n    });\n\n    const labelArcs = data.map((item, index) => {\n      if (labelRadius) {\n        return shape\n          .arc()\n          .outerRadius(_labelRadius)\n          .innerRadius(_labelRadius)\n          .padAngle(padAngle);\n      }\n      return arcs[index];\n    });\n\n    const pieSlices = shape\n      .pie()\n      .value((d) => valueAccessor({item: d}))\n      .sort(sort)\n      .startAngle(startAngle)\n      .endAngle(endAngle)(data);\n\n    const slices = pieSlices.map((slice, index) => ({\n      ...slice,\n      pieCentroid: arcs[index].centroid(slice),\n      labelCentroid: labelArcs[index].centroid(slice),\n    }));\n\n    const extraProps = {\n      width,\n      height,\n      data,\n      slices,\n    };\n\n    return (\n      <View style={style}>\n        <View style={{flex: 1}} onLayout={(event) => this._onLayout(event)}>\n          {height > 0 && width > 0 && (\n            <Svg style={{height, width}}>\n              {/* center the progress circle*/}\n              <G x={width / 2} y={height / 2}>\n                {React.Children.map(children, (child) => {\n                  if (child && child.props.belowChart) {\n                    return React.cloneElement(child, extraProps);\n                  }\n                  return null;\n                })}\n                {pieSlices.map((slice, index) => {\n                  const {key, onPress, svg} = data[index];\n                  return (\n                    <Path\n                      key={key}\n                      onPress={onPress}\n                      {...svg}\n                      d={arcs[index](slice)}\n                      animate={animate}\n                      animationDuration={animationDuration}\n                    />\n                  );\n                })}\n                {React.Children.map(children, (child) => {\n                  if (child && !child.props.belowChart) {\n                    return React.cloneElement(child, extraProps);\n                  }\n                  return null;\n                })}\n              </G>\n            </Svg>\n          )}\n        </View>\n      </View>\n    );\n  }\n}\n\nPieChart.propTypes = {\n  data: PropTypes.arrayOf(\n    PropTypes.shape({\n      svg: PropTypes.object,\n      key: PropTypes.any.isRequired,\n      value: PropTypes.number,\n      arc: PropTypes.object,\n    }),\n  ).isRequired,\n  innerRadius: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  outerRadius: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  labelRadius: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  padAngle: PropTypes.number,\n  animate: PropTypes.bool,\n  animationDuration: PropTypes.number,\n  style: PropTypes.any,\n  sort: PropTypes.func,\n  valueAccessor: PropTypes.func,\n};\n\nPieChart.defaultProps = {\n  width: 100,\n  height: 100,\n  padAngle: 0.05,\n  startAngle: 0,\n  endAngle: Math.PI * 2,\n  valueAccessor: ({item}) => item.value,\n  innerRadius: '50%',\n  sort: (a, b) => b.value - a.value,\n};\n\nexport default PieChart;\n"]}