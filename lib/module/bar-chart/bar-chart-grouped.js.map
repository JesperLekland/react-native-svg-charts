{"version":3,"sources":["bar-chart-grouped.js"],"names":["GroupedBarChart","domain","props","horizontal","contentInset","left","right","spacingInner","spacingOuter","clamp","width","state","scale","scaleLinear","range","scaleBand","paddingInner","paddingOuter","top","bottom","height","x","y","data","yAccessor","_data","map","obj","svg","item","value","areas","barWidth","bandwidth","length","forEach","collectionIndex","valueIndex","push","bar","path","shape","area","_index","x0","x1","defined","y0","y1","gridMin","gridMax","dataExtent","array","merge","extent","yMin","yMax","_","index","BarChart","propTypes","PropTypes","arrayOf","isRequired","object"],"mappings":"o5BAAA,6DACA,uDACA,uDACA,uDACA,6D,k7CAEMA,CAAAA,e,0TACOC,M,CAAQ,iBAOb,KAAKC,KAPQ,CAEfC,UAFe,aAEfA,UAFe,mCAGfC,YAHe,8CAGAC,IAHA,CAGAA,IAHA,iCAGO,CAHP,qEAGUC,KAHV,CAGUA,KAHV,iCAGkB,CAHlB,wBAIfC,YAJe,aAIfA,YAJe,CAKfC,YALe,aAKfA,YALe,CAMfC,KANe,aAMfA,KANe,IASVC,CAAAA,KATU,CASD,KAAKC,KATJ,CASVD,KATU,CAWjB,GAAIP,UAAJ,CAAgB,CACd,MAAOS,CAAAA,KAAK,CACTC,WADI,GAEJZ,MAFI,CAEGA,MAFH,EAGJa,KAHI,CAGE,CAACT,IAAD,CAAOK,KAAK,CAAGJ,KAAf,CAHF,EAIJG,KAJI,CAIEA,KAJF,CAAP,CAKD,CAED,MAAOG,CAAAA,KAAK,CACTG,SADI,GAEJd,MAFI,CAEGA,MAFH,EAGJa,KAHI,CAGE,CAACT,IAAD,CAAOK,KAAK,CAAGJ,KAAf,CAHF,EAIJU,YAJI,CAIS,CAACT,YAAD,CAJT,EAKJU,YALI,CAKS,CAACT,YAAD,CALT,CAAP,CAMD,C,8CAEUP,M,CAAQ,kBAOb,KAAKC,KAPQ,CAEfC,UAFe,cAEfA,UAFe,CAGfI,YAHe,cAGfA,YAHe,CAIfC,YAJe,cAIfA,YAJe,oCAKfJ,YALe,8CAKAc,GALA,CAKAA,GALA,iCAKM,CALN,qEAKSC,MALT,CAKSA,MALT,iCAKkB,CALlB,wBAMfV,KANe,cAMfA,KANe,IASVW,CAAAA,MATU,CASA,KAAKT,KATL,CASVS,MATU,CAWjB,GAAIjB,UAAJ,CAAgB,CACd,MAAOS,CAAAA,KAAK,CACTG,SADI,GAEJd,MAFI,CAEGA,MAFH,EAGJa,KAHI,CAGE,CAACI,GAAD,CAAME,MAAM,CAAGD,MAAf,CAHF,EAIJH,YAJI,CAIS,CAACT,YAAD,CAJT,EAKJU,YALI,CAKS,CAACT,YAAD,CALT,CAAP,CAMD,CAED,MAAOI,CAAAA,KAAK,CACTC,WADI,GAEJZ,MAFI,CAEGA,MAFH,EAGJa,KAHI,CAGE,CAACM,MAAM,CAAGD,MAAV,CAAkBD,GAAlB,CAHF,EAIJT,KAJI,CAIEA,KAJF,CAAP,CAKD,C,4CAESY,C,CAAGC,C,CAAG,kBACwB,KAAKpB,KAD7B,CACPC,UADO,cACPA,UADO,CACKoB,IADL,cACKA,IADL,CACWC,SADX,cACWA,SADX,CAGd,GAAMC,CAAAA,KAAK,CAAGF,IAAI,CAACG,GAAL,CAAS,SAACC,GAAD,CAAS,cACXA,GADW,CACvBC,GADuB,CACvBA,GADuB,mBACjB,EADiB,UAE9B,wBACKD,GADL,EAEEJ,IAAI,CAAEI,GAAG,CAACJ,IAAJ,CAASG,GAAT,CAAa,SAACG,IAAD,CAAU,CAC3B,GAAI,MAAOA,CAAAA,IAAP,GAAgB,QAApB,CAA8B,CAC5B,MAAO,CACLC,KAAK,CAAED,IADF,CAELD,GAAG,CAAHA,GAFK,CAAP,CAID,CAED,wBACKC,IADL,EAEED,GAAG,kBACEA,GADF,IAEEC,IAAI,CAACD,GAFP,CAFL,CAMEE,KAAK,CAAEN,SAAS,CAAC,CAACK,IAAI,CAAJA,IAAD,CAAD,CANlB,GAQD,CAhBK,CAFR,GAoBD,CAtBa,CAAd,CAwBA,GAAME,CAAAA,KAAK,CAAG,EAAd,CAEA,GAAI5B,UAAJ,CAAgB,CACd,GAAM6B,CAAAA,QAAQ,CAAGV,CAAC,CAACW,SAAF,GAAgBV,IAAI,CAACW,MAAtC,CAEAT,KAAK,CAACU,OAAN,CAAc,SAACR,GAAD,CAAMS,eAAN,CAA0B,CACtCT,GAAG,CAACJ,IAAJ,CAASY,OAAT,CAAiB,SAACN,IAAD,CAAOQ,UAAP,CAAsB,CACrCN,KAAK,CAACO,IAAN,CAAW,CACTC,GAAG,CAAEV,IADI,CAETW,IAAI,CAAEC,KAAK,CACRC,IADG,GAEHpB,CAFG,CAED,SAACQ,KAAD,CAAQa,MAAR,QACDA,CAAAA,MAAM,GAAK,CAAX,CACIrB,CAAC,CAACe,UAAD,CAAD,CAAgBL,QAAQ,CAAGI,eAD/B,CAEId,CAAC,CAACe,UAAD,CAAD,CAAgBL,QAAhB,CAA2BA,QAAQ,CAAGI,eAHzC,EAFC,EAOHQ,EAPG,CAOAvB,CAAC,CAAC,CAAD,CAPD,EAQHwB,EARG,CAQA,SAACf,KAAD,QAAWT,CAAAA,CAAC,CAACS,KAAD,CAAZ,EARA,EASHgB,OATG,CASK,SAAChB,KAAD,QAAW,OAAOA,CAAAA,KAAP,GAAiB,QAA5B,EATL,EAS2C,CAC/CD,IAAI,CAACC,KAD0C,CAE/CD,IAAI,CAACC,KAF0C,CAT3C,CAFG,CAAX,EAgBD,CAjBD,EAkBD,CAnBD,EAoBD,CAvBD,IAuBO,CACL,GAAME,CAAAA,SAAQ,CAAGX,CAAC,CAACY,SAAF,GAAgBV,IAAI,CAACW,MAAtC,CAEAT,KAAK,CAACU,OAAN,CAAc,SAACR,GAAD,CAAMS,eAAN,CAA0B,CACtCT,GAAG,CAACJ,IAAJ,CAASY,OAAT,CAAiB,SAACN,IAAD,CAAOQ,UAAP,CAAsB,CACrCN,KAAK,CAACO,IAAN,CAAW,CACTC,GAAG,CAAEV,IADI,CAETW,IAAI,CAAEC,KAAK,CACRC,IADG,GAEHrB,CAFG,CAED,SAACS,KAAD,CAAQa,MAAR,QACDA,CAAAA,MAAM,GAAK,CAAX,CACItB,CAAC,CAACgB,UAAD,CAAD,CAAgBL,SAAQ,CAAGI,eAD/B,CAEIf,CAAC,CAACgB,UAAD,CAAD,CAAgBL,SAAhB,CAA2BA,SAAQ,CAAGI,eAHzC,EAFC,EAOHW,EAPG,CAOAzB,CAAC,CAAC,CAAD,CAPD,EAQH0B,EARG,CAQA,SAAClB,KAAD,QAAWR,CAAAA,CAAC,CAACQ,KAAD,CAAZ,EARA,EASHgB,OATG,CASK,SAAChB,KAAD,QAAW,OAAOA,CAAAA,KAAP,GAAiB,QAA5B,EATL,EAS2C,CAC/CD,IAAI,CAACC,KAD0C,CAE/CD,IAAI,CAACC,KAF0C,CAT3C,CAFG,CAAX,EAgBD,CAjBD,EAkBD,CAnBD,EAoBD,CAED,MAAOC,CAAAA,KAAP,CACD,C,+CAEY,kBACiC,KAAK7B,KADtC,CACJqB,IADI,cACJA,IADI,CACEC,SADF,cACEA,SADF,CACayB,OADb,cACaA,OADb,CACsBC,OADtB,cACsBA,OADtB,CAEX,GAAMC,CAAAA,UAAU,CAAGC,KAAK,CAACC,KAAN,CACjB9B,IAAI,CAACG,GAAL,CAAS,SAACC,GAAD,QAASA,CAAAA,GAAG,CAACJ,IAAJ,CAASG,GAAT,CAAa,SAACG,IAAD,QAAUL,CAAAA,SAAS,CAAC,CAACK,IAAI,CAAJA,IAAD,CAAD,CAAnB,EAAb,CAAT,EAAT,CADiB,CAAnB,CAIA,GAAMyB,CAAAA,MAAM,CAAGF,KAAK,CAACE,MAAN,2CAAiBH,UAAjB,GAA6BD,OAA7B,CAAsCD,OAAtC,GAAf,CANW,iBAQkC,KAAK/C,KARvC,gCAQJqD,IARI,CAQJA,IARI,4BAQGD,MAAM,CAAC,CAAD,CART,kDAQcE,IARd,CAQcA,IARd,4BAQqBF,MAAM,CAAC,CAAD,CAR3B,mBAUX,MAAO,CAACC,IAAD,CAAOC,IAAP,CAAP,CACD,C,iDAEa,IACLjC,CAAAA,IADK,CACG,KAAKrB,KADR,CACLqB,IADK,CAEZ,MAAOA,CAAAA,IAAI,CAAC,CAAD,CAAJ,CAAQA,IAAR,CAAaG,GAAb,CAAiB,SAAC+B,CAAD,CAAIC,KAAJ,QAAcA,CAAAA,KAAd,EAAjB,CAAP,CACD,C,6BAvJ2BC,iB,EA0J9B3D,eAAe,CAAC4D,SAAhB,kBACKD,kBAASC,SADd,EAEErC,IAAI,CAAEsC,mBAAUC,OAAV,CACJD,mBAAUpB,KAAV,CAAgB,CACdlB,IAAI,CAAEsC,mBAAUT,KAAV,CAAgBW,UADR,CAEdnC,GAAG,CAAEiC,mBAAUG,MAFD,CAAhB,CADI,EAKJD,UAPJ,G,aAUe/D,e","sourcesContent":["import PropTypes from 'prop-types';\nimport * as array from 'd3-array';\nimport * as scale from 'd3-scale';\nimport * as shape from 'd3-shape';\nimport BarChart from './bar-chart';\n\nclass GroupedBarChart extends BarChart {\n  calcXScale(domain) {\n    const {\n      horizontal,\n      contentInset: {left = 0, right = 0},\n      spacingInner,\n      spacingOuter,\n      clamp,\n    } = this.props;\n\n    const {width} = this.state;\n\n    if (horizontal) {\n      return scale\n        .scaleLinear()\n        .domain(domain)\n        .range([left, width - right])\n        .clamp(clamp);\n    }\n\n    return scale\n      .scaleBand()\n      .domain(domain)\n      .range([left, width - right])\n      .paddingInner([spacingInner])\n      .paddingOuter([spacingOuter]);\n  }\n\n  calcYScale(domain) {\n    const {\n      horizontal,\n      spacingInner,\n      spacingOuter,\n      contentInset: {top = 0, bottom = 0},\n      clamp,\n    } = this.props;\n\n    const {height} = this.state;\n\n    if (horizontal) {\n      return scale\n        .scaleBand()\n        .domain(domain)\n        .range([top, height - bottom])\n        .paddingInner([spacingInner])\n        .paddingOuter([spacingOuter]);\n    }\n\n    return scale\n      .scaleLinear()\n      .domain(domain)\n      .range([height - bottom, top])\n      .clamp(clamp);\n  }\n\n  calcAreas(x, y) {\n    const {horizontal, data, yAccessor} = this.props;\n\n    const _data = data.map((obj) => {\n      const {svg = {}} = obj;\n      return {\n        ...obj,\n        data: obj.data.map((item) => {\n          if (typeof item === 'number') {\n            return {\n              value: item,\n              svg,\n            };\n          }\n\n          return {\n            ...item,\n            svg: {\n              ...svg,\n              ...item.svg,\n            },\n            value: yAccessor({item}),\n          };\n        }),\n      };\n    });\n\n    const areas = [];\n\n    if (horizontal) {\n      const barWidth = y.bandwidth() / data.length;\n\n      _data.forEach((obj, collectionIndex) => {\n        obj.data.forEach((item, valueIndex) => {\n          areas.push({\n            bar: item,\n            path: shape\n              .area()\n              .y((value, _index) =>\n                _index === 0\n                  ? y(valueIndex) + barWidth * collectionIndex\n                  : y(valueIndex) + barWidth + barWidth * collectionIndex,\n              )\n              .x0(x(0))\n              .x1((value) => x(value))\n              .defined((value) => typeof value === 'number')([\n              item.value,\n              item.value,\n            ]),\n          });\n        });\n      });\n    } else {\n      const barWidth = x.bandwidth() / data.length;\n\n      _data.forEach((obj, collectionIndex) => {\n        obj.data.forEach((item, valueIndex) => {\n          areas.push({\n            bar: item,\n            path: shape\n              .area()\n              .x((value, _index) =>\n                _index === 0\n                  ? x(valueIndex) + barWidth * collectionIndex\n                  : x(valueIndex) + barWidth + barWidth * collectionIndex,\n              )\n              .y0(y(0))\n              .y1((value) => y(value))\n              .defined((value) => typeof value === 'number')([\n              item.value,\n              item.value,\n            ]),\n          });\n        });\n      });\n    }\n\n    return areas;\n  }\n\n  calcExtent() {\n    const {data, yAccessor, gridMin, gridMax} = this.props;\n    const dataExtent = array.merge(\n      data.map((obj) => obj.data.map((item) => yAccessor({item}))),\n    );\n\n    const extent = array.extent([...dataExtent, gridMax, gridMin]);\n\n    const {yMin = extent[0], yMax = extent[1]} = this.props;\n\n    return [yMin, yMax];\n  }\n\n  calcIndexes() {\n    const {data} = this.props;\n    return data[0].data.map((_, index) => index);\n  }\n}\n\nGroupedBarChart.propTypes = {\n  ...BarChart.propTypes,\n  data: PropTypes.arrayOf(\n    PropTypes.shape({\n      data: PropTypes.array.isRequired,\n      svg: PropTypes.object,\n    }),\n  ).isRequired,\n};\n\nexport default GroupedBarChart;\n"]}